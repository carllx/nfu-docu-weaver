# Story 2.2: Add Creative Project

## Status

Draft

## Story

**As a** 导师,
**I want** 注册一个毕业创作项目，并能指定其成员（一个或多个学生ID）,
**so that** 我能将项目信息添加到系统中央索引并自动创建相应的项目知识库目录结构。

## Acceptance Criteria

1. 项目ID、名称及成员关系被准确添加到 `docs/cohort_registry.md` 中。
2. 系统会自动在 `cohort_data/creative_projects/` 目录下创建对应的项目**目录**和 `index.md` 文件。

## Tasks / Subtasks

- [ ] Task 1 (AC: 1, 2)
  - [ ] Subtask 1.1: 实现 `*po add-entity --type creative-project` 命令解析和参数处理
  - [ ] Subtask 1.2: 创建项目ID生成逻辑，遵循 `CP_YYYY_A##` 格式规范
  - [ ] Subtask 1.3: 实现项目信息添加到 `docs/cohort_registry.md` 的逻辑
  - [ ] Subtask 1.4: 创建 `cohort_data/creative_projects/[ID_Name]/` 目录结构
  - [ ] Subtask 1.5: 生成项目 `index.md` 档案文件，包含必要的元数据和结构
  - [ ] Subtask 1.6: 实现成员关系验证和链接逻辑（验证学生ID存在）
  - [ ] Subtask 1.7: 验证添加后的中央索引文件格式正确且可被AI agents解析
  - [ ] Subtask 1.8: 添加操作成功消息和错误处理机制
  - [ ] Subtask 1.9: 测试完整的项目注册工作流程

## Dev Notes

### Previous Story Insights

从故事 2.1 中获得的关键见解：
- 中央索引 `docs/cohort_registry.md` 已经存在并包含完整的学生和项目数据
- 学生知识库目录结构已成功创建 (`cohort_data/students/`)
- 系统配置驱动架构已建立，支持实体ID格式规范
- AI agents 能够正确解析和操作中央索引文件
- 文件操作需要保持严格的格式一致性
- 实体目录创建模式已验证可行

### Data Models

**毕业创作实体结构** [Source: architecture/architecture-03-data-model-entities.md#3.1]
- **ID 格式**: `CP_YYYY_A##` (例如: `CP_2026_A01`)
- **文件路径**: `cohort_data/creative_projects/[ID_Name]/index.md`
- **核心属性**: `project_id`, `title`, `track`, `members` (链接到学生ID), `progress`, `feedback_log`
- **描述**: 代表一个毕业创作项目，可以是个人项目或小组项目

**中央索引结构** [Source: architecture/architecture-03-data-model-entities.md#3.2]
- `docs/cohort_registry.md` 维护三项关键信息：
  - 实体注册：记录所有实体的存在及其唯一ID
  - 核心元数据：存储最常查询的核心信息（项目名称、专业方向、状态）
  - 关系链接：定义实体之间的关系（项目成员关系）

**当前中央索引状态**：
- 已存在完整的学生表格结构（10名学生）
- 已存在完整的项目表格结构（10个项目：CP_2026_A01 到 CP_2026_A10）
- 项目格式：分为小组项目和个人项目两个部分
- 包含项目ID、名称、专业方向、成员、状态信息

### API Specifications

**命令接口设计**：
- 命令格式：`*po add-entity --type creative-project`
- 参数要求：需要交互式收集项目名称、专业方向、成员ID等信息
- 成员验证：需要验证指定的学生ID在系统中存在
- 响应格式：返回新创建的项目ID和确认信息
- 错误处理：处理重复项目名称、无效成员ID、无效专业方向等异常情况

### Component Specifications

此故事不涉及 UI 组件，主要是命令行交互和文件系统操作。

### File Locations

**主要操作文件** [Source: architecture/architecture-05-directory-structure.md#5.1]
- 目标文件：`docs/cohort_registry.md` - 中央索引文件
- 项目目录：`cohort_data/creative_projects/[Project_ID_Name]/` - 项目知识库
- 项目档案：`cohort_data/creative_projects/[Project_ID_Name]/index.md` - 项目仪表盘

**目录结构要求** [Source: architecture/architecture-05-directory-structure.md#5.1]
- 项目知识库包含以下子目录：
  - `_research/` - 文献研究
  - `_drafts/` - 草稿版本
  - `_assets/` - 视觉资产
  - `_feedback_archive/` - 反馈归档
- 配置文件：`config/system_config.md` - 获取默认状态和专业方向

### Testing Requirements

- 验证命令解析和参数处理正确性
- 测试项目ID生成算法的唯一性和格式规范
- 验证中央索引文件更新的正确性和格式保持
- 测试目录和文件创建的完整性
- 确认新创建的文件可被AI agents正确解析
- 验证成员关系验证逻辑（学生ID存在性检查）
- 验证错误处理机制（重复添加、无效成员ID等）
- 测试与现有项目数据的兼容性
- 验证小组项目和个人项目的正确分类

### Technical Constraints

**系统设计原则** [Source: architecture/architecture-02-high-level-architecture.md#2.2]
- 必须遵循"配置驱动"原则：从 `config/system_config.md` 获取默认状态
- 保持"中央索引"的完整性：确保索引与数据分离模式
- 确保"命令驱动接口"的一致性：统一的命令格式和响应

**文件格式要求**
- 必须保持 Markdown 格式
- 保留表格结构以供 AI agents 解析
- 维护文档头部信息（版本、负责人、说明）
- 确保新添加的条目格式与现有条目一致
- 正确处理小组项目和个人项目的分类显示

**ID生成约束**
- 必须遵循 `CP_YYYY_A##` 格式
- 年份应从配置文件或系统日期获取
- 序号应自动递增，避免冲突
- 支持最多99个项目（A01-A99）

**目录命名规范**
- 格式：`[Project_ID_Name]` (例如：`CP_2026_A01_交互绘本睡前故事`)
- 确保文件系统兼容性（避免特殊字符）
- 保持与现有目录结构的一致性

**成员关系约束**
- 必须验证所有指定的成员ID在学生表中存在
- 支持单个成员（个人项目）和多个成员（小组项目）
- 成员ID必须遵循 `S_YYYY_##` 格式
- 需要在中央索引中正确显示成员信息

### Testing

**测试文件位置**: 基于项目结构，测试应放在适当位置

**测试标准**:
- 单元测试：测试ID生成、文件操作、数据验证、成员关系验证逻辑
- 集成测试：测试完整的项目添加工作流程
- 验收测试：确保满足所有验收标准

**具体测试要求**:
- 测试命令参数解析和验证
- 验证项目ID生成的唯一性
- 测试中央索引文件更新逻辑
- 验证目录和文件创建完整性
- 测试成员ID验证逻辑
- 测试错误场景处理
- 验证与现有数据的兼容性
- 测试项目分类逻辑（小组vs个人）

## Change Log

| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-01-12 | 1.0 | Initial story creation | sm |

## Dev Agent Record

### Agent Model Used

*待开发代理填写*

### Debug Log References

*待开发代理填写*

### Completion Notes List

*待开发代理填写*

### File List

*待开发代理填写*

## QA Results

*待QA代理填写*
