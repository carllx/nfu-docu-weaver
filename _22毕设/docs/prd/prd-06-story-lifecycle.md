## 6. 故事生命周期与质量标准 (Story Lifecycle & Quality Standards)

本章节为所有AI代理（特别是sm, dev, qa）和导师在处理用户故事时，提供了必须遵循的核心原则和流程。

### 6.1 故事生成原则 (INVEST)

sm (Scrum Master) 代理在执行 `*sm create` 命令生成故事时，必须确保每个故事都符合以下INVEST质量标准：

- **I - Independent (独立的)**: 故事应尽可能自成体系，不依赖于其他故事。这使得它们可以被独立开发和验证。
    
- **N - Negotiable (可协商的)**: 故事不是一份严格的合同，而是一个需求的开端。导师应可以在Draft阶段对其进行评审和微调。
    
- **V - Valuable (有价值的)**: 每个故事完成后，都必须为系统或用户带来明确、可感知的价值。例如，实现了一个新命令，或自动化了一个流程。
    
- **E - Estimable (可估算的)**: 故事的范围必须足够清晰，以便dev代理能够"估算"其复杂性（即，可以在一个独立的会话中完成）。
    
- **S - Small (小颗粒度的)**: 故事必须足够小，能够被一个dev代理在一次独立的、不间断的开发会话中完成。任何过于庞大的故事都应被拆分成更小的、可独立交付的故事。
    
- **T - Testable (可测试的)**: 故事必须包含清晰、无歧义的验收标准（Acceptance Criteria），以便其完成后可以被客观地验证。
    

### 6.2 故事状态与生命周期

每个故事文件都包含一个 Status 字段，其状态必须遵循以下生命周期：

- **Draft (草稿)**: 故事由sm代理生成后的初始状态。此时，导师应审查其内容，确保其符合INVEST原则。
    
- **Approved (已批准)**: 导师审查完毕并手动将状态修改为此。只有处于此状态的故事才能被dev代理执行。
    
- **InProgress (开发中)**: dev代理开始执行故事任务时，会自动将状态更新为此。
    
- **Review (待审查)**: dev代理完成所有任务后，会将状态更新为此。这标志着开发工作已完成，等待导师或qa代理的最终验收。
    
- **Done (已完成)**: 故事通过最终验收，满足所有"完成的定义"后，由导师或qa代理更新为此最终状态。
    

### 6.3 系统级"完成"的定义 (Definition of "Done")

一个故事只有在满足以下所有条件时，才能被最终标记为 Done：

- ✅ 所有在故事中定义的任务/子任务均已完成。
    
- ✅ 所有验收标准 (Acceptance Criteria) 均已得到满足和验证。
    
- ✅ dev代理已在故事文件中记录了所有被创建或修改的文件列表。
    
- ✅ 故事的实现没有导致system_integrity_checklist.md中的任何一项检查失败。
    
- ✅ 故事文件本身的 Status 字段已被更新为 Done。