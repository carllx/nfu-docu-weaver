

![|200](https://i.ytimg.com/vi/v41xKxZmygU/hqdefault.jpg)
(Source: [youtube.com: 设置Gemini记忆文件/ (205) 🚀保姆级教程！Google震撼发布Gemini CLI！100万TOKEN超长上下文远超Claude Code，支持MCP Server扩展，开发者的终极AI！Context7+Task Master - YouTube](https://youtu.be/v41xKxZmygU?t=574))


**重点整理**

在我这次的影片中，我详细演示了Google最新发布的AI编程工具——Gemini CLI。

*   **Gemini CLI简介与定位**：我首先介绍了Google在昨天晚上发布的这款全新的AI编程工具Gemini CLI，并指出它可以作为Anthropic的Claude Code和OpenAI的Codex CLI的替代品。它具备100万Token的超长上下文窗口，能轻松处理包含多个文件的复杂项目。

*   **核心功能展示**：
    1.  **MCP Server集成**：我演示了Gemini CLI可以轻松调用外部工具，比如通过集成Context7 Server来获取最新的库文档，或使用Taskmaster来自动生成产品需求文档（PRD）并拆解成开发任务。
    2.  **自定义记忆文件**：我展示了如何通过创建一个`GEMINI.md`文件，来为项目设定特定的开发规范、代码风格和技术栈要求，让Gemini CLI在后续开发中严格遵循这些规则，从而实现更规范、更高效的开发。

*   **安装与配置**：
    1.  **环境准备**：我强调了安装前需要确保系统中已安装Node.js（推荐v20版本）。
    2.  **安装步骤**：我演示了如何使用官方提供的`npx`命令一键安装，并通过Google账户进行授权。
    3.  **MCP Server配置**：我详细说明了如何通过修改`~/.gemini/settings.json`配置文件来添加MCP Server，并提供了Context7和Taskmaster的配置示例。

*   **实战演练**：
    1.  **代码分析与重构**：我利用Gemini CLI的超长上下文能力，对一个开源AI智能体框架`smol-agents`进行了完整的架构分析、代码解释和重构建议。
    2.  **遵循规范开发**：我创建了一个`GEMINI.md`文件来定义一个基于AutoGen框架的AI智能体项目规范。Gemini CLI完全遵循了文件中的规定（如Python 3.11、AutoGen 0.4、项目结构等）为我开发了一个能制定旅游规划的AI智能体。
    3.  **智能调试**：在开发过程中，我演示了当代码出现错误时，可以直接将报错信息反馈给Gemini CLI，它能自动分析并修复错误。
    4.  **任务自动化**：最后，我演示了如何调用Taskmaster，让它根据一个简单的需求（开发一个iOS的To-do list App）自动生成详细的PRD文档，并将其拆解为10个具体的开发子任务，极大地简化了项目启动流程。

如果你想亲自体验，本期视频用到的所有代码、配置和笔记，我都放在了视频下方的描述栏和评论区，你也可以访问我的博客`www.aivi.fyi`找到相关内容。

**影片逐字稿**

[00:00] **讲者**: Google在昨天晚上发布了全新的AI编程工具Gemini CLI。  
[00:07] **讲者**: 这款AI编程工具能够平替Anthropic发布的Claude Code，以及OpenAI发布的Codex CLI。  
[00:14] **讲者**: Gemini CLI一发布就具备非常多的功能，包括支持MCP Server的功能。  
[00:19] **讲者**: 我们可以轻松在Gemini CLI中来调用MCP Server，比如说我这里调用的Context7 Server，还有Taskmaster。  
[00:27] **讲者**: 像这样，我们就能为Gemini CLI扩展更多的功能。  
[00:31] **讲者**: 它还支持为项目自定义记忆文件。  
[00:34] **讲者**: 像这样就可以让Gemini CLI遵循我们设置的这个记忆文件里的这些规则，进行编程开发。  
[00:41] **讲者**: 而且最关键的是，Gemini CLI能够像Gemini Pro 2.5一样，能够支持超过100万TOKEN的上下文窗口。  
[00:49] **讲者**: 100万TOKEN的上下文窗口相当于2-3个Flask规模的完整项目，或者十几个常见的Python库的完整代码。  
[00:57] **讲者**: 这个长度的上下文窗口，开发者可以轻松分析整个项目的架构，进行跨文件的代码重构，理解复杂代码的依赖关系。  
[01:07] **讲者**: 本期视频将为大家详细演示Gemini CLI的使用方式。  
[01:11] **讲者**: 并且为大家演示在Gemini CLI中调用MCP Server。  
[01:14] **讲者**: 还会为大家演示在Gemini CLI中设置记忆文件，让Gemini CLI遵循我们在文件中设置的这些规则，来为我们开发我们所需要的项目。  
[01:25] **讲者**: 在安装Gemini CLI之前，首先我们要确保我们已经下载并且安装了Node.js。  
[01:31] **讲者**: 这里推荐安装v20这个版本。  
[01:33] **讲者**: 我们只需要根据自己的操作系统去下载安装包进行安装就可以。  
[01:37] **讲者**: 下面我们复制Gemini官方给出的这个安装命令，然后我们打开终端命令行，Windows用户打开CMD，然后我们直接粘贴并且运行就可以。  
[01:47] **讲者**: 然后这里我们可以直接默认选择这个暗色的主题。  
[01:50] **讲者**: 然后这里需要我们登录Google的账户。  
[01:53] **讲者**: 跳到这个页面就说明登录成功。  
[01:55] **讲者**: 下面我们再返回终端命令行。  
[01:57] **讲者**: 可以看到这里默认的是Gemini 2.5 Pro这个模型。  
[02:01] **讲者**: 下面我们可以用help命令来查看一下Gemini CLI的使用方式。  
[02:05] **讲者**: 这里它给出了使用方式，包括所有的这些命令， **[02:07] (影像补充：屏幕上显示了/help、/docs、/theme、/auth、/stats等命令列表)** 包括MCP的命令，还包括设置记忆文件的命令，还有列出所有可用工具的这个命令。  
[02:14] **讲者**: 在这些命令中，还包括这个以叹号开头的这个特殊的命令。  
[02:18] **讲者**: 用这个叹号开头，我们就可以执行shell命令。  
[02:21] **讲者**: 比如说我们在这里输入一个叹号pwd，来显示当前的路径。  
[02:25] **讲者**: 这里就输出了当前的这个路径。  
[02:27] **讲者**: 下面这里就是给出的常用的快捷键。  
[02:30] **讲者**: 好，为了方便演示，下面我们可以直接在VS Code或者在PyCharm中来使用Gemini CLI。  
[02:37] **讲者**: 想在VS Code中使用非常简单，我们只需要打开VS Code的终端，然后在终端命令行中来启动Gemini CLI就可以。  
[02:45] **讲者**: 下面我们可以发挥Gemini CLI它的超长上下文窗口的能力，让它来分析一个开源的项目。  
[02:52] **讲者**: 我们直接用这个开源的AI智能体框架smol-agents，让Gemini CLI为我们进行详细的分析。  
[02:58] **讲者**: 好，首先我们将这个项目克隆到我们的VS Code里。  
[03:03] **讲者**: 下面我们直接输入一个@符号，然后选中这个项目的路径。  
[03:07] **讲者**: 下面我们就可以输入提示词，我输入的提示词是 **[03:09] (影像补充：屏幕上显示的完整提示词为：“@smolagents/ 分析这个项目的整体架构，包括：- 主要模块和它们的职责 - 数据流向和依赖关系 - 设计模式的使用 - 潜在的架构问题”)** 分析这个项目的整体架构，直接发送。  
[03:13] **讲者**: 这里分析完成，下面我们可以详细看一下。  
[03:16] **讲者**: 首先是主要模块还有他们的职责，包括项目的核心 **[03:19] (影像补充：屏幕上列出了agents.py、models.py、tools.py和memory.py等核心文件及其职责)** ，定义了agent的行为框架。  
[03:22] **讲者**: 下面这里是模型抽象层，这里是工具定义与管理，这里是记忆管理。  
[03:28] **讲者**: 然后下面是这些数据流向。  
[03:30] **讲者**: 这里是设计模式的使用。  
[03:32] **讲者**: 在这里它给出了潜在的架构问题。  
[03:34] **讲者**: 然后下面我们还可以让它对项目中的代码进行详细的解释。  
[03:38] **讲者**: 我们这里可以找一个文件。  
[03:40] **讲者**: 下面我们就可以在对话框输入@符号，然后再找到这个文件。  
[03:44] **讲者**: 我们直接输入提示词，详细分析代码的功能，然后直接发送。  
[03:47] **讲者**: 这里它开始输出这个分析结果。  
[03:51] **讲者**: 他说这个文件是这个智能体的核心。  
[03:53] **讲者**: 这里列举出了这个文件里的3个核心类。  
[03:57] **讲者**: 下面是对这3个核心类的详细解释。  
[04:00] **讲者**: 最后这里给出了这个总结。  
[04:02] **讲者**: 下面我们还可以测试一下，让它对这个项目的代码重构给出建议。  
[04:06] **讲者**: 然后我们直接输入提示词，分析代码并提供重构建议。  
[04:10] **讲者**: 这里它输出了这个项目存在的问题，包括这个核心的代码。  
[04:15] **讲者**: 然后下面是给出的优化建议。  
[04:17] **讲者**: 在这里，他指出了函数复杂度的这个问题 **[04:18] (影像补充：屏幕上明确指出问题存在于agents.py文件中的run和_process_model_response方法)**，然后这里给出了拆分的方法。  
[04:22] **讲者**: 下面这里是依赖关系的优化。  
[04:25] **讲者**: 最后这里给出了这个总结。  
[04:26] **讲者**: 刚才我们在VS Code中来使用了Gemini CLI，下面我们还可以在PyCharm中来使用Gemini CLI。  
[04:32] **讲者**: 在PyCharm中创建一个项目。  
[04:35] **讲者**: 项目创建好之后，我们就可以在左侧这里点击终端。  
[04:38] **讲者**: 下面我们测试一下在PyCharm中使用Gemini CLI，使用微软的AI智能体框架AutoGen，来为我们开发一个AI智能体的工作流。  
[04:46] **讲者**: 好，为了让Gemini CLI获取到AutoGen的最新文档，我们需要为Gemini CLI添加一个能够获取最新文档的MCP Server。  
[04:55] **讲者**: 我们这里就用Context7 MCP，因为这个MCP Server它可以获取绝大部分开源项目以及库的最新文档。  
[05:03] **讲者**: 下面我们可以测试一下，为Gemini CLI加入MCP Server的支持。  
[05:08] **讲者**: 想配置这个MCP Server非常简单，我们只需要找到这个MCP Server它给的这个配置文件就可以 **[05:11] (影像补充：屏幕显示了Context7的JSON配置示例，包含mcpServers、context7、command和args等字段)**。  
[05:14] **讲者**: 我们可以直接在PyCharm的终端命令行，然后大家也可以直接在系统默认的终端命令行。  
[05:20] **讲者**: 然后我们只需要执行  `cd ~/.gemini`  ，来切换到Gemini CLI的这个配置路径。  
[05:25] **讲者**: 然后再执行 `nano settings.json`来打开这个配置文件。  
[05:28] **讲者**: 好，像这样的话，我们就可以看到这个配置文件里的内容了。  
[05:31] **讲者**: 这里默认的是主题设置，然后这里默认的是认证方式。  
[05:34] **讲者**: 然后下面这里我就添加了两个MCP Server，第一个就是Context7这个MCP Server。  
[05:40] **讲者**: 第二个就是Taskmaster这个MCP Server。  
[05:43] **讲者**: 其中Taskmaster这个MCP Server，它能为我们生成产品需求文档，还能为我们将产品需求文档拆解为子任务。  
[05:51] **讲者**: 如果大家对这个MCP Server不熟悉的话，可以点击视频右上方的链接，来查看我之前对这个MCP Server的介绍和演示。  
[06:00] **讲者**: 或者从视频下方评论区置顶的链接来查看我之前发布的关于这个MCP Server的使用视频。  
[06:06] **讲者**: 好，为了方便大家快速配置，我会将这个配置文件完整的放在视频下方链接的笔记里，大家可以直接复制就可以使用。  
[06:14] **讲者**: 这些设置好之后，我们直接按快捷键Ctrl+O，再按Enter键，再按Ctrl+X。  
[06:20] **讲者**: 下面我们在PyCharm中来启动Gemini CLI。  
[06:23] **讲者**: 我们就可以来使用我们刚才配置好的MCP Server了。  
[06:27] **讲者**: 好，下面我们就可以来测试一下，我们输入斜线，然后再输入mcp。  
[06:31] **讲者**: 我们就可以看到我们刚才配置的Context7 MCP Server，还有Taskmaster这个MCP Server，而且这里都列出了这两个MCP Server里所支持的所有工具。  
[06:42] **讲者**: 下面我们就可以来测试一下，我们直接输入提示词，使用Context7搜索AutoGen最新版的新特性。  
[06:49] **讲者**: 这里它提示是否允许调用工具，然后我们直接选择第三项，允许它调用这里面的所有工具。  
[06:55] **讲者**: 可以看到这里他用Context7来搜索到了AutoGen的这些文档。  
[06:59] **讲者**: 然后下面这里，他从搜索结果中获取到了AutoGen最新的新特性。  
[07:04] **讲者**: 下面我们就可以输入提示词，让他用AutoGen为我们开发一个简单的AI智能体工作流。  
[07:09] **讲者**: 我们直接输入提示词， **[07:11] (影像补充：屏幕上显示的完整提示词为：“使用context7搜索AutoGen最新版的新特性，并为我开发一个能够根据需求编写代码的agent，编写的代码由第二个agent给出优化建议，再由第三个agent根据第一个agent对代码和第二个agent的建议，写出最终的代码”)** 使用Context7搜索AutoGen最新版的新特性，并为我开发一个能够根据需求编写代码的agent，编写的代码由第二个agent给出优化建议，再由第三个agent根据第一个agent的代码还有第二个agent的建议写出最终的代码。  
[07:22] **讲者**: 然后我们直接发送，看一下这个效果。  
[07:25] **讲者**: 这里它提示它需要修改这些文件，然后我们这里选择始终允许。  
[07:29] **讲者**: 这里这个代码已经编写完成，然后这里还给出了这些运行方式，还有这些总结。  
[07:36] **讲者**: 在这个代码中，这里是导入所需的这些依赖，然后这里是配置这些API Key。  
[07:40] **讲者**: 然后下面这里，它就为我们定义了几个智能体，包括第一个用于代码生成的智能体，然后第二个用于代码审查的智能体，就是进行代码集成的这个智能体。  
[07:50] **讲者**: 然后这里是初始化的一个任务， **[07:51] (影像补充：屏幕代码中显示initial_task = """Please write a Python function that finds the nth prime number...""")** 写一个Python函数来查找第n个素数。  
[07:56] **讲者**: 下面我们就可以来测试一下。  
[07:58] **讲者**: 首先我们按照代码中这个文档，我们创建好这个文件，并且将这段代码粘贴在文件里。  
[08:03] **讲者**: 然后这里我们要设置好OpenAI的API Key。  
[08:06] **讲者**: 下面我们运行一下代码进行测试。  
[08:09] **讲者**: 可以看到这里成功运行，没有出现报错。  
[08:11] **讲者**: 然后这里是这个任务 **[08:12] (影像补充：屏幕显示“UserProxy (to chat_manager):”后跟具体的任务内容)**。  
[08:12] **讲者**: 这里它输出了这个代码。  
[08:14] **讲者**: 然后下面将由这个代码审计的agent对这个代码进行审查，这是他对这个代码给出的建议和审查结果。  
[08:21] **讲者**: 下面这里到了第三个agent，他会对这个代码进行重新优化。  
[08:25] **讲者**: 这里就是他优化后的这个更加完整的代码。  
[08:28] **讲者**: 像这样的话，我们就在Gemini CLI中调用Context7 MCP Server，使用AutoGen框架，为我们开发了一个能够优化代码的一个AI智能体工作流。  
[08:38] **讲者**: 为了达到更好的开发效果，以及做到更规范的开发效果。  
[08:42] **讲者**: 我们还可以使用Gemini的这个记忆文件。  
[08:45] **讲者**: 我们直接输入斜线，然后再输入memory。  
[08:47] **讲者**: 你就可以看到这个memory的这三个参数，包括显示，包括刷新，还有这个增加。  
[08:52] **讲者**: 然后为了让Gemini CLI为我们开发出更符合AutoGen这款智能体代码规范的一个智能体工作流。  
[08:59] **讲者**: 然后我们可以创建一个记忆文件，这样的话Gemini CLI就可以从记忆文件中读取这些代码规范，还有一些更具体的要求。  
[09:07] **讲者**: 下面我们新建一个文件，给它命名成Gemini.md。  
[09:11] **讲者**: 下面我们需要在这个文件中来输入具体的开发规范，还有代码风格等要求。  
[09:17] **讲者**: 下面我们可以看一下我设置的这个文件里的这些开发规范，还有这些具体的要求 **[09:19] (影像补充：屏幕上展示的GEMINI.md文件结构包含“项目概述”、“环境配置”、“安装步骤”、“编程规范”、“代码风格”、“项目结构”和“MCP服务器配置”等多个部分)**。  
[09:23] **讲者**: 首先这里我们规定了让他使用AutoGen 0.4的这个版本来开发AI智能体。  
[09:28] **讲者**: Python的版本是3.11，并且使用venv虚拟环境。  
[09:32] **讲者**: 然后下面这里我们告诉了他这个虚拟环境的创建，还有环境激活，还有如何安装AutoGen所需的这些依赖，还有这些编程规范，还有就是代码风格。  
[09:42] **讲者**: 下面这里是AutoGen的这些基本的设置，还有语法。  
[09:46] **讲者**: 然后这里是我们告诉他了，这个项目的结构。  
[09:49] **讲者**: 下面这里是环境变量的设置，让他放入这个env文件中。  
[09:53] **讲者**: 下面我们告诉他了这些开发要点。  
[09:55] **讲者**: 下面是关键部分，我们让它始终使用Context7这个MCP Server来搜索AutoGen的最新文档，还有代码规范，优先使用AutoGen 0.4官方文档。  
[10:06] **讲者**: 而下面是这些搜索策略，而且还告诉他所有代码示例都使用中文注释。  
[10:11] **讲者**: 遇到问题时，优先使用Context7搜索最新解决方案。  
[10:15] **讲者**: 下面我们就可以完整的复制这个内容，然后直接放入我们刚才创建好的这个文件中，然后关闭就可以。  
[10:22] **讲者**: 然后下面我们就可以在Gemini CLI中，然后输入memory refresh，让它来刷新这个文件。  
[10:28] **讲者**: 再用memory show来显示一下我们刚才设置的这个记忆文件。  
[10:31] **讲者**: 这里就已经完全显示了我们刚才设置的这个记忆文件。  
[10:35] **讲者**: 像这样的话，Gemini CLI在后续为我们编写代码或者开发项目的时候，它就会率先遵循我们刚才给它设置的这些规则。  
[10:44] **讲者**: 好，下面我们就可以来输入提示词测试一下，我这里直接输入一个最简单的提示词，为我开发一个能够制定旅游规划的AI智能体。  
[10:52] **讲者**: 然后我们直接发送。  
[10:54] **讲者**: 好，下面这里他显然调用了我们刚才创建的记忆文件中的这些规则， **[10:55] (影像补充：AI回复：“好的，我们可以开始开发一个旅游规划AI智能体。我将使用 AutoGen 框架和 Python 3.11 来构建这个智能体，并遵循您在 GEMINI.md 中提供的项目规范。”)** 包括他提到，他将使用Python 3.11来构建智能体，并且完全遵循我们这个文件中的项目规范。  
[11:04] **讲者**: 下面这里他输出了这个分布开发计划 **[11:05] (影像补充：AI输出的第一步是：“1. 项目结构设置: 我将创建 main.py 作为主入口文件，一个 agents 目录用于存放智能体定义...”)**。  
[11:07] **讲者**: 在最后他询问我们这个计划是否可以，然后我们直接输入可以。  
[11:12] **讲者**: 它开始为我们创建这个项目的文件。  
[11:15] **讲者**: 可以看到下面就是它为我们编写的这些代码。  
[11:19] **讲者**: 下面我们就可以运行一下测试一下。  
[11:21] **讲者**: 我们先在配置文件中设置好API Key。  
[11:23] **讲者**: 然后关闭，然后我们打开终端来运行一下。  
[11:26] **讲者**: 这里正在运行。  
[11:27] **讲者**: 运行之后可以看到这里出现报错，我们直接完整的复制这个报错，然后发送给Gemini CLI。  
[11:33] **讲者**: 这样的话，它就会为我们来修复这个错误。  
[11:36] **讲者**: 现在开始修复。  
[11:37] **讲者**: 这里这个错误它修复完成。  
[11:39] **讲者**: 下面我们测试一下能否成功运行。  
[11:42] **讲者**: 运行之后，他这里提示需要输入旅游需求。  
[11:45] **讲者**: 然后我们直接输入制定一个去尼泊尔的三天旅游计划。  
[11:48] **讲者**: 看一下这个效果。  
[11:50] **讲者**: 这里他成功输出了这个三天旅行计划，这是第一天，然后这是第二天，这是第三天。  
[11:56] **讲者**: 下面是预算的估算，还有交通方式，还有景点推荐等。  
[12:00] **讲者**: 像这样的话，我们就使用Gemini CLI，遵循我们制定的这个开发规则，然后为我们开发了这个能够制定旅游规划AI智能体。  
[12:09] **讲者**: 下面我们还可以测试一下，在Gemini CLI中调用Taskmaster，来根据我们的需求生成产品需求文档，并且将产品需求文档拆解为具体的开发任务。  
[12:20] **讲者**: 下面我们可以输入提示词，我想开发一款可以在iOS上运行的to-do list App，使用Taskmaster生成PRD文件并拆解为10个子任务。  
[12:30] **讲者**: 这里它提示需要调用Taskmaster，然后我们这里选择第三项，允许它调用这里面的所有工具。  
[12:36] **讲者**: 这里它已经为我们生成了这个PRD文件的内容。  
[12:40] **讲者**: 然后这里它提示是否同意写入这个文件，我们直接输入同意。  
[12:44] **讲者**: 它需要为我们创建10个子任务。  
[12:46] **讲者**: 这里它已经生成了这个任务，然后并且保存到了这个文件。  
[12:50] **讲者**: 这是它为我们生成的产品需求文档。  
[12:53] **讲者**: 然后这里就是他根据产品需求文档拆解为的10个任务。  
[12:57] **讲者**: 大家就可以根据拆解后的子任务，在Gemini CLI中完成整个项目的开发。  
[13:03] **讲者**: 为了节省时间，这里就不再为大家继续去演示了。  
[13:06] **讲者**: 本期视频所用到的代码和笔记，我都会放在视频下方的描述栏或者评论区。  
[13:11] **讲者**: 如果你在视频下方无法找到的话，他也可以通过我的博客去查找本期视频所对应的笔记。  
[13:17] **讲者**: 好，本期视频就做到这里，欢迎大家点赞关注和转发，谢谢大家观看。

---
