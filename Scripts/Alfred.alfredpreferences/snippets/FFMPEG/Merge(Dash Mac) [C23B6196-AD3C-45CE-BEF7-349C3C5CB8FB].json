{
  "alfredsnippet" : {
    "snippet" : "folder_dir={clipboard}\n\n\ninit_file=\"$(find \"$folder_dir\" -type f -name init.mp4)\"\nif [ -n \"$init_file\" ]; then\n    echo \"Found init.mp4 at: $init_file\"\nelse\n    echo \"init.mp4 not found in $folder_dir\"\nfi\n\ndeclare -A start_for_identifier\ndeclare -A end_for_identifier\ndeclare -a identifiers\n\nfor file in $(ls $folder_dir); do\n    if [[ $file =~ ^P([0-9]+)-([0-9.]+)-([0-9.]+)-([0-9]+)\\.m4s$ ]]; then\n        identifier=\"${match[1]}\"\n        start=\"${match[2]}\"\n        end=\"${match[3]}\"\n\n        if [[ -z \"${start_for_identifier[$identifier]}\" ]]; then\n            identifiers+=(\"$identifier\")\n        fi\n\n        if [[ -z \"${start_for_identifier[$identifier]}\" || \"${start_for_identifier[$identifier]}\" -gt \"$start\" ]]; then\n            start_for_identifier[$identifier]=\"$start\"\n        fi\n\n        if [[ -z \"${end_for_identifier[$identifier]}\" || \"${end_for_identifier[$identifier]}\" -lt \"$end\" ]]; then\n            end_for_identifier[$identifier]=\"$end\"\n        fi\n    fi\ndone\n\nfolder_temp=\"$folder_dir\/temp\"\ndir_concat=\"${folder_temp}\/concat.txt\"\n\nfor identifier in \"${identifiers[@]}\"; do\n    echo \"Identifier: $identifier, Start: ${start_for_identifier[$identifier]}, End: ${end_for_identifier[$identifier]}\"\n    \n    videoFiles=()\n    file_temp_pre=\"$folder_temp\/Pre${identifier}.mp4\"\n    mkdir -p \"$(dirname \"$file_temp_pre\")\"\n    \n    if [ -n \"$init_file\" ]; then\n        echo \"(Part$identifier) Adding init file to temp\"\n        cat \"$init_file\" >> \"$file_temp_pre\"\n    fi\n\n    find \"$folder_dir\" -type f -iname \"P${identifier}*.m4s\" -print0 | sort -z -V | while IFS= read -r -d '' file; do\n        echo \"(Part$identifier) Adding m4s to temp\"\n        cat \"$file\" >> \"$file_temp_pre\"\n    done\n    \n    duration=$(echo \"${end_for_identifier[$identifier]} - ${start_for_identifier[$identifier]}\" | bc -l)\n    echo \"(Part$identifier) Rendering temp file with seconds: ${duration}\"\n    file_temp=\"$folder_temp\/Render${identifier}.mp4\"\n    ffmpeg -i $file_temp_pre -ss 0 -c copy  -t $duration \"$file_temp\"\n    echo \"file '$file_temp'\" >> \"$dir_concat\"\n\n    rm -rf \"$file_temp_pre\"\ndone\n\nname=$(basename \"${folder_dir}\")\nffmpeg -f concat -safe 0 -i \"$dir_concat\" -c copy -movflags +faststart \"$folder_dir\/$name.mp4\"",
    "uid" : "C23B6196-AD3C-45CE-BEF7-349C3C5CB8FB",
    "name" : "Merge(Dash & Mac)",
    "keyword" : "macmergedash"
  }
}