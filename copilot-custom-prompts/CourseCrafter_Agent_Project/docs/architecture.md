# “_CourseCrafter Agent” 架构文档

版本: 1.0

作者: BMad - Mary (商业分析师)

## 1. 架构概述

本项目采用一种**基于 Prompt 工程和外部知识库（RAG - Retrieval-Augmented Generation）的 AI 代理架构**。其核心思想是通过一个高度结构化的核心指令（System Prompt）来定义代理的行为，并通过链接外部知识源来确保其专业性和准确性。

这种架构具有高度的灵活性和可维护性，因为它将代理的“逻辑”（Prompt）与“知识”（Data）分离开来。

## 2. 核心组件

### 2.1 AI 代理核心 (Agent Core)

- **技术栈**: 任何支持长上下文和自定义系统提示词的大型语言模型（LLM），例如 OpenAI 的 GPT-4、Anthropic 的 Claude 3 等。
    
- **实现**: 通过部署在根目录 `_CourseCrafter.md` 中的 **v1.1 版核心指令** 来实现。该指令定义了代理的身份、原则、工作流和输出格式。
    

### 2.2 知识库 (Knowledge Base)

- **技术栈**: Obsidian.md 或任何支持通过文件名链接进行检索的本地 Markdown 文件系统。这是实现 RAG 的基础。
    
- **实现**: 存放在根目录 `data/` 文件夹中的一系列 Markdown 文件。每个文件代表一个核心理论，由用户负责维护和更新。
    

### 2.3 工作流引擎 (Workflow Engine)

- **技术栈**: 由 LLM 本身的逻辑推理能力驱动。
    
- **实现**: 在核心指令的 **# 工作流程 (WORKFLOW)** 部分有明确定义。代理通过遵循这一系列指令，模拟出一个确定性的、分步骤的思考过程，从而保证了输出的稳定性和一致性。
    

## 3. 数据流与交互流程

```
graph TD
    A[用户] -->|1. 提供讲义| B(_CourseCrafter Agent);
    B -->|2. 内部处理| C{核心指令 v1.1};
    C -->|3. 引用知识| D[[知识库 .md 文件]];
    B -->|4. 主动询问/推荐| A;
    A -->|5. 确认框架| B;
    B -->|6. 生成方案| E[结构化活动方案];
    E -->|7. 交付| A;

    subgraph AI 代理内部
        C;
        D;
    end
```

**流程说明:**

1. **用户输入**: 用户向代理提供课程讲义。
    
2. **代理启动**: 代理加载其核心指令，开始执行工作流程。
    
3. **知识检索**: 在工作流程的特定步骤，代理会根据指令中的 `[[笔记名称]]` 链接，从知识库中检索相关理论要点。
    
4. **人机交互**: 代理在完成初步分析后，会暂停流程，向用户提出推荐并请求决策。
    
5. **用户确认**: 用户提供反馈，使流程得以继续。
    
6. **方案生成**: 代理完成所有创意和构建步骤。
    
7. **最终输出**: 代理将结果按照预设的 Markdown 格式组装并交付给用户。
    

## 4. 部署与维护

- **部署**: 将核心指令部署到 AI 平台，并将知识库文件夹放置在可供检索的位置。
    
- **维护**:
    
    - **代理逻辑更新**: 直接修改根目录的 `_CourseCrafter.md` 文件。
        
    - **知识库更新**: 在根目录 `data/` 文件夹中添加或修改理论笔记 .md 文件。