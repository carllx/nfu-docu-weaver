# Docu-Weaver Agent

`Docu-Weaver` æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆå·¥å…·ã€‚å®ƒé€šè¿‡è¯»å–ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶ï¼ˆå¦‚ YAMLï¼‰å’Œ Word æ–‡æ¡£æ¨¡æ¿ï¼Œæ‰¹é‡ç”Ÿæˆå†…å®¹å„å¼‚ä½†æ ¼å¼ç»Ÿä¸€çš„æœ€ç»ˆæ–‡æ¡£ï¼Œæ—¨åœ¨å°†ä¸“ä¸šäººå‘˜ä»ç¹çã€é‡å¤çš„æ–‡æ¡£æ’°å†™å·¥ä½œä¸­è§£æ”¾å‡ºæ¥ã€‚

---

## éœ€æ±‚

- Python 3.7+

## å®‰è£…

1. å…‹éš†æœ¬é¡¹ç›®ä»“åº“ã€‚
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€éœ€çš„ä¾èµ–åº“ï¼š

```bash
pip install -r requirements.txt
```

## ä½¿ç”¨æ–¹æ³•

`Docu-Weaver` é€šè¿‡ `generate_docs.py` è„šæœ¬æä¾›æœåŠ¡ï¼Œè¯¥è„šæœ¬åŒ…å«å››ä¸ªä¸»è¦å‘½ä»¤ï¼š`analyze`ã€`validate`ã€`generate` å’Œ `batch`ã€‚

### 1. `analyze` - åˆ†ææ•°æ®æ–‡ä»¶

æ­¤å‘½ä»¤ç”¨äºå¿«é€Ÿç»Ÿè®¡ä¸€ä¸ªç›®å½•ä¸­åŒ…å«çš„ `.yml` æˆ– `.yaml` æ•°æ®æ–‡ä»¶çš„æ•°é‡ã€‚

**å‘½ä»¤æ ¼å¼**:
```bash
python generate_docs.py analyze <ç›®å½•è·¯å¾„> [--recursive]
```

**å‚æ•°è¯´æ˜**:
- `<ç›®å½•è·¯å¾„>`: è¦åˆ†æçš„ç›®å½•
- `--recursive` æˆ– `-r`: é€’å½’æ‰«æå­ç›®å½•ï¼ˆå¯é€‰ï¼‰

**ç¤ºä¾‹**:
```bash
# åˆ†æå½“å‰ç›®å½•
python generate_docs.py analyze ./test_data

# é€’å½’åˆ†ææ‰€æœ‰å­ç›®å½•
python generate_docs.py analyze ./data --recursive
```

**è¾“å‡ºç¤ºä¾‹**:
```json
{
  "success": true,
  "file_count": 15,
  "files": ["lesson1.yml", "lesson2.yml", ...]
}
```

### 2. `validate` - éªŒè¯æ•°æ®å®Œæ•´æ€§ ğŸ†•

æ­¤å‘½ä»¤ç”¨äºåœ¨ç”Ÿæˆæ–‡æ¡£å‰éªŒè¯æ•°æ®æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æ‰€æœ‰å¿…éœ€çš„å­—æ®µéƒ½å·²æä¾›ã€‚

**å·¥ä½œåŸç†**:

è„šæœ¬ä¼šæå–æ¨¡æ¿ä¸­çš„æ‰€æœ‰å ä½ç¬¦ï¼Œç„¶åæ£€æŸ¥æ•°æ®æ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«å¯¹åº”çš„é”®å€¼ã€‚

**å‘½ä»¤æ ¼å¼**:
```bash
# å•æ–‡ä»¶éªŒè¯
python generate_docs.py validate <æ•°æ®æ–‡ä»¶> <æ¨¡æ¿æ–‡ä»¶>

# æ‰¹é‡éªŒè¯
python generate_docs.py validate --batch <æ•°æ®ç›®å½•> <æ¨¡æ¿æ–‡ä»¶>
```

**å‚æ•°è¯´æ˜**:
- `<æ•°æ®æ–‡ä»¶>`: YAMLæ•°æ®æ–‡ä»¶è·¯å¾„ï¼ˆå•æ–‡ä»¶æ¨¡å¼ï¼‰
- `<æ¨¡æ¿æ–‡ä»¶>`: Wordæ¨¡æ¿æ–‡ä»¶è·¯å¾„
- `--batch <æ•°æ®ç›®å½•>`: æ•°æ®æ–‡ä»¶ç›®å½•è·¯å¾„ï¼ˆæ‰¹é‡æ¨¡å¼ï¼‰

**ç¤ºä¾‹**:
```bash
# éªŒè¯å•ä¸ªæ•°æ®æ–‡ä»¶
python generate_docs.py validate test_data/lesson1.yml template.docx

# æ‰¹é‡éªŒè¯æ‰€æœ‰æ•°æ®æ–‡ä»¶
python generate_docs.py validate --batch ./test_data/batch template.docx
```

**è¾“å‡ºç¤ºä¾‹**:
```
âœ… éªŒè¯é€šè¿‡: test_data/lesson1.yml

âš ï¸  è­¦å‘Š (1):
  - æœªä½¿ç”¨çš„æ•°æ®é”®: 'extra_field'

{
  "file": "test_data/lesson1.yml",
  "valid": true,
  "errors": [],
  "warnings": [...]
}
```

### 3. `generate` - ç”Ÿæˆå•ä¸ªæ–‡æ¡£

æ­¤å‘½ä»¤ä½¿ç”¨å•ä¸ªæ•°æ®æ–‡ä»¶å’Œæ¨¡æ¿æ–‡ä»¶æ¥ç”Ÿæˆä¸€ä»½æœ€ç»ˆæ–‡æ¡£ã€‚

**å·¥ä½œåŸç†**:

è„šæœ¬ä¼šè¯»å–æŒ‡å®šçš„ Word æ¨¡æ¿ (`.docx`)ï¼ŒæŸ¥æ‰¾æ‰€æœ‰ `{{key}}` æ ¼å¼çš„å ä½ç¬¦ï¼Œå¹¶å°†å…¶æ›¿æ¢ä¸ºæ•°æ®æ–‡ä»¶ (`.yml`) ä¸­å¯¹åº”çš„ `key` çš„å€¼ã€‚

**å‘½ä»¤æ ¼å¼**:
```bash
python generate_docs.py generate <æ•°æ®æ–‡ä»¶> <æ¨¡æ¿æ–‡ä»¶> <è¾“å‡ºç›®å½•> [é€‰é¡¹]
```

**å‚æ•°è¯´æ˜**:
- `<æ•°æ®æ–‡ä»¶>`: YAMLæ•°æ®æ–‡ä»¶è·¯å¾„
- `<æ¨¡æ¿æ–‡ä»¶>`: Wordæ¨¡æ¿æ–‡ä»¶è·¯å¾„
- `<è¾“å‡ºç›®å½•>`: è¾“å‡ºç›®å½•è·¯å¾„
- `-o, --output`: æŒ‡å®šè¾“å‡ºæ–‡ä»¶å®Œæ•´è·¯å¾„ï¼ˆå¯é€‰ï¼‰
- `--debug`: å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆå¯é€‰ï¼‰

**ç¤ºä¾‹**:
```bash
# åŸºæœ¬ç”¨æ³•
python generate_docs.py generate test_data/lesson1.yml template.docx output/

# æŒ‡å®šè¾“å‡ºæ–‡ä»¶å
python generate_docs.py generate data/lesson1.yml template.docx output/ -o output/my_lesson.docx
```

**è¾“å‡ºç¤ºä¾‹**:
```
æ–‡æ¡£å·²æˆåŠŸç”Ÿæˆ: output/lesson1.docx
  - å¤„ç†æ®µè½: 1
  - å¤„ç†è¡¨æ ¼å•å…ƒæ ¼: 5
{"success": true, "output_path": "output/lesson1.docx"}
```

### 4. `batch` - æ‰¹é‡ç”Ÿæˆæ–‡æ¡£

æ­¤å‘½ä»¤å¯ä»¥ä¸€æ¬¡æ€§å¤„ç†æ•´ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰æ•°æ®æ–‡ä»¶ï¼Œæ‰¹é‡ç”Ÿæˆå¤šä¸ªæ–‡æ¡£ã€‚

**å‘½ä»¤æ ¼å¼**:
```bash
python generate_docs.py batch <æ•°æ®ç›®å½•> <æ¨¡æ¿æ–‡ä»¶> <è¾“å‡ºç›®å½•> [é€‰é¡¹]
```

**å‚æ•°è¯´æ˜**:
- `<æ•°æ®ç›®å½•>`: åŒ…å«å¤šä¸ªYAMLæ–‡ä»¶çš„ç›®å½•
- `<æ¨¡æ¿æ–‡ä»¶>`: Wordæ¨¡æ¿æ–‡ä»¶è·¯å¾„
- `<è¾“å‡ºç›®å½•>`: è¾“å‡ºç›®å½•è·¯å¾„
- `--continue-on-error`: é‡åˆ°é”™è¯¯æ—¶ç»§ç»­å¤„ç†å…¶ä»–æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
- `--debug`: å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
- `-q, --quiet`: å®‰é™æ¨¡å¼ï¼Œä»…æ˜¾ç¤ºé”™è¯¯ï¼ˆå¯é€‰ï¼‰ğŸ†•
- `-v, --verbose`: è¯¦ç»†æ¨¡å¼ï¼Œæ˜¾ç¤ºæ‰€æœ‰å¤„ç†ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ğŸ†•

**ç¤ºä¾‹**:
```bash
# æ‰¹é‡ç”Ÿæˆæ‰€æœ‰æ–‡æ¡£ï¼ˆé»˜è®¤æ¨¡å¼ - æ˜¾ç¤ºè¿›åº¦æ¡ï¼‰
python generate_docs.py batch ./test_data ./template.docx ./output

# å®‰é™æ¨¡å¼ - æ— è¾“å‡º
python generate_docs.py batch ./data ./template.docx ./output --quiet

# è¯¦ç»†æ¨¡å¼ - æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
python generate_docs.py batch ./data ./template.docx ./output --verbose

# é‡é”™ç»§ç»­å¤„ç†
python generate_docs.py batch ./data ./template.docx ./output --continue-on-error
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰**:
```
å¼€å§‹æ‰¹é‡ç”Ÿæˆæ–‡æ¡£...
æ€»å…±å‘ç° 2 ä¸ªæ•°æ®æ–‡ä»¶
æ‰¹é‡ç”Ÿæˆæ–‡æ¡£: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 21.88file/s]

============================================================
æ‰¹é‡ç”Ÿæˆå®Œæˆ!
  âœ… æˆåŠŸ: 2
  âŒ å¤±è´¥: 0
  ğŸ“Š æ€»è®¡: 2
============================================================
```

## âœ… å·²å®ç°åŠŸèƒ½ (v1.3.0)

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **å®Œæ•´çš„æ ¼å¼ä¿ç•™**: 100% ä¿ç•™æ¨¡æ¿ä¸­çš„æ‰€æœ‰æ ·å¼
  - å­—ä½“åç§°ã€å¤§å°ã€é¢œè‰²
  - **ä¸­æ–‡å­—ä½“æ­£ç¡®æ˜¾ç¤º**ï¼ˆä¿®å¤ eastAsia å±æ€§ï¼‰
  - ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ç­‰æ–‡æœ¬ä¿®é¥°
  - æ®µè½å¯¹é½ã€ç¼©è¿›ã€è¡Œé—´è·
- âœ… **è¡¨æ ¼æ”¯æŒ**: æ”¯æŒè¡¨æ ¼å•å…ƒæ ¼ä¸­çš„å ä½ç¬¦æ›¿æ¢
- âœ… **Markdown æ¸²æŸ“**: æ”¯æŒ `**ç²—ä½“**` å’Œ `*æ–œä½“*` è¯­æ³•
- âœ… **å¤šæ®µè½æ”¯æŒ**: æ”¯æŒ `\n` å’Œ `\n\n` æ¢è¡Œç¬¦
- âœ… **åµŒå¥—æ•°æ®**: æ”¯æŒ `key.subkey` å½¢å¼çš„åµŒå¥—è®¿é—®
- âœ… **åˆ—è¡¨æ•°æ®**: è‡ªåŠ¨å°†åˆ—è¡¨è½¬æ¢ä¸ºæ¢è¡Œåˆ†éš”çš„æ–‡æœ¬

### æ‰¹é‡å¤„ç†åŠŸèƒ½ (v1.2.0)
- âœ… **analyze å‘½ä»¤**: å¿«é€Ÿç»Ÿè®¡ç›®å½•ä¸­çš„æ•°æ®æ–‡ä»¶æ•°é‡
- âœ… **batch å‘½ä»¤**: ä¸€æ¬¡æ€§æ‰¹é‡ç”Ÿæˆå¤šä¸ªæ–‡æ¡£
- âœ… **é”™è¯¯æ¢å¤**: æ”¯æŒ `--continue-on-error` é€‰é¡¹
- âœ… **JSONè¾“å‡º**: æ‰€æœ‰å‘½ä»¤æ”¯æŒç»“æ„åŒ–JSONè¾“å‡º

### ç”¨æˆ·ä½“éªŒå¢å¼º ğŸ†• (v1.3.0)
- âœ… **è¿›åº¦æ¡æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºæ‰¹é‡å¤„ç†è¿›åº¦ï¼ˆåŸºäº tqdmï¼‰
  - é»˜è®¤æ¨¡å¼ï¼šè¿›åº¦æ¡ + å¤„ç†é€Ÿåº¦
  - å®‰é™æ¨¡å¼ (`-q`): æ— è¾“å‡º
  - è¯¦ç»†æ¨¡å¼ (`-v`): å®Œæ•´å¤„ç†ä¿¡æ¯
- âœ… **æ•°æ®éªŒè¯**: ç”Ÿæˆå‰éªŒè¯æ•°æ®å®Œæ•´æ€§
  - YAML è¯­æ³•æ£€æŸ¥
  - å¿…éœ€é”®éªŒè¯ï¼ˆåŸºäºæ¨¡æ¿ï¼‰
  - é¢å¤–é”®è­¦å‘Š
  - å•æ–‡ä»¶å’Œæ‰¹é‡éªŒè¯æ¨¡å¼
- âœ… **æµ‹è¯•æ¡†æ¶**: å®Œæ•´çš„è‡ªåŠ¨åŒ–æµ‹è¯•
  - 34 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆ100% é€šè¿‡ï¼‰
  - pytest + pytest-cov é›†æˆ
  - å¿«é€Ÿæµ‹è¯•è¿è¡Œï¼ˆ~2sï¼‰

### å·²çŸ¥é™åˆ¶
- æ•°æ®æ ¼å¼ä»…æ”¯æŒ YAMLï¼ˆJSON/CSV æ”¯æŒè®¡åˆ’åœ¨æœªæ¥ç‰ˆæœ¬ï¼‰
- æµ‹è¯•è¦†ç›–ç‡çº¦ 70-75%ï¼ˆç›®æ ‡ >80%ï¼‰

## ğŸ“ é¡¹ç›®æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
- ğŸ“‹ [PRD - äº§å“éœ€æ±‚æ–‡æ¡£](docs/prd.md)
- ğŸ—ï¸ [Architecture - æ¶æ„æ–‡æ¡£](docs/architecture/index.md)
- ğŸ“Š [Sprint Progress - è¿›åº¦è·Ÿè¸ª](docs/SPRINT_PROGRESS.md)
- ğŸ“ [CHANGELOG - ç‰ˆæœ¬å†å²](CHANGELOG.md)

### æµ‹è¯•éªŒè¯
**éªŒè¯é€šè¿‡çš„æµ‹è¯•ç”¨ä¾‹** (100% Pass Rate):
- âœ… æ™®é€šæ®µè½æ ¼å¼ä¿ç•™ (100%)
- âœ… è¡¨æ ¼å•å…ƒæ ¼æ ¼å¼ä¿ç•™ (100%)
- âœ… å¤šè¡Œæ–‡æœ¬æ ¼å¼ä¸€è‡´æ€§ (100%)
- âœ… Markdown æ ¼å¼æ¸²æŸ“ (100%)
- âœ… ä¸­æ–‡å­—ä½“æ­£ç¡®æ˜¾ç¤º (100%)

è¯¦è§ [Sprint Progress](docs/SPRINT_PROGRESS.md#quality-metrics)

## ğŸš€ æœªæ¥æ”¹è¿› (è·¯çº¿å›¾)

### V1.4.0 - æµ‹è¯•ä¸æ€§èƒ½ä¼˜åŒ– (è®¡åˆ’ä¸­)
- **æµ‹è¯•è¦†ç›–ç‡æå‡**: ä» 70% æå‡åˆ° >80%
- **æ€§èƒ½åŸºå‡†æµ‹è¯•**: å¤§è§„æ¨¡æ–‡ä»¶ï¼ˆ1000+ï¼‰æ€§èƒ½éªŒè¯
- **CI/CD é›†æˆ**: GitHub Actions è‡ªåŠ¨æµ‹è¯•
- **é”™è¯¯æ—¥å¿—å¢å¼º**: è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯

### V2.0.0 - Agent äº¤äº’å¼å·¥ä½œæµ
- **äº¤äº’å¼ç¡®è®¤**: ç”Ÿæˆå‰ç¡®è®¤å·¥ä½œè®¡åˆ’
- **å¢é‡äº¤ä»˜**: ä¸€æ¬¡ä¸€ä»½çš„ç”Ÿæˆå’Œå®¡æŸ¥æµç¨‹
- **æ™ºèƒ½éªŒè¯**: AI è¾…åŠ©çš„æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
- **LLM é›†æˆ**: ä¸å¤§è¯­è¨€æ¨¡å‹æ·±åº¦é›†æˆ

### V3.0.0 - æ‰©å±•æ”¯æŒ
- **æ”¯æŒæ›´å¤šæ•°æ®æ ¼å¼**: JSON, CSV, Excel ç­‰
- **æ”¯æŒæ›´å¤šæ¨¡æ¿æ ¼å¼**: Markdown, HTML æ¨¡æ¿
- **é«˜çº§æ•°æ®å¤„ç†**: å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­ã€æ•°æ®è½¬æ¢
- **æ¨¡æ¿å¸‚åœº**: é¢„ç½®å¸¸ç”¨æ¨¡æ¿åº“
