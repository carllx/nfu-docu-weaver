# “Docu-Weaver” Agent 产品需求文档 (PRD)

## 1. Goals and Background Context (目标与背景上下文)

### Goals (目标)

- **核心目标 (Core Goal):** 极大地提升从结构化数据到最终格式化文档的转化效率，同时保证并提升产出文档的质量与规范性。
    
- **通用性目标 (Generality Goal):** 确保 `Docu-Weaver` Agent 能够处理任意领域的结构化数据源和内容模板，不局限于特定行业。
    
- **智能化与协作目标 (Intelligence & Collaboration Goal):** 将 `Agent` 构建成一个智能协作伙伴，使其不仅能执行生成任务，还能主动与用户沟通、确认指令，并适应不同的数据-模板映射关系。
    

### Background Context (背景上下文)

当前，从结构化数据（如 YAML 文件）到一系列内容各异但格式统一的正式文档（如报告、合同、教案、规格书）的转化过程，是一个劳动密集型的流程。专业人员需手动进行大量重复的拆解、复制和格式调整，不仅耗时巨大，还难以保证所有文档与数据源的实时同步和质量统一。

为解决此核心痛点，我们提出构建 `Docu-Weaver` Agent。该智能代理旨在通过自动化的工作流，将结构化数据智能地映射并生成为最终的文档。它将作为一个协作伙伴，通过主动确认、增量交付等功能，将专业人员从繁琐的重复性工作中解放出来，让他们能更专注于内容的创造与核心业务，从而保证信息产出的效率、一致性和标准化。

### Change Log (变更日志)

|   |   |   |   |
|---|---|---|---|
|**Date**|**Version**|**Description**|**Author**|
|2025-10-04|2.0|升级为通用文档生成项目|PM (John)|
|2025-10-03|1.0|初始文档创建|PM (John)|

## 2. Requirements (需求)

### Functional (功能性需求)

- **FR1: 接收输入**: Agent 必须能够接收用户提供的**结构化数据源**（MVP阶段为 YAML 文件）和**内容模板**（MVP阶段为 Word 的 .docx 文件）。
    
- **FR2: 解析数据**: Agent 必须能够解析指定目录下的所有数据文件，并理解其层级结构。
    
- **FR3: 内容映射**: Agent 必须能够识别模板文件中的占位符，并将其与数据文件中的键（key）进行准确映射。
    
- **FR4: 生成文档**: Agent 必须为数据目录中的每一个数据文件生成一份独立的、内容已填充的最终文档。
    
- **FR5: 交互式工作流**: Agent 必须遵循一个交互式工作流程：
    
    - **FR5.1: 计划确认**: 在开始批量生成前，向用户展示其工作计划（如“我将为您生成10份文档”）并请求确认。
        
    - **FR5.2: 增量交付**: 采用“一次一份”的方式生成文档，每完成一份就呈现给用户。
        
    - **FR5.3: 提交审查**: 在呈现每一份生成的文档后，主动请求用户审查和反馈，并等待用户指令再继续。
        

### Non-Functional (非功能性需求)

- **NFR1: 性能 (Performance)**: Agent 的处理和生成速度应足够快，目标是相比手动编写，能节省90%以上的时间。
    
- **NFR2: 准确性 (Accuracy)**: 生成的文档内容必须100%准确地反映数据源中的信息，不得遗漏或捏造。
    
- **NFR3: 可用性 (Usability)**: 对于有基本技术知识的用户，Agent 的交互流程应清晰易懂，数据格式（YAML）和模板占位符的规则应简单明了。
    
- **NFR4: 实现技术 (Implementation)**: Agent 的核心逻辑将基于 Python 实现，并可由大语言模型（LLM）进行封装和调用。
    
- **NFR5: 兼容性 (Compatibility)**: MVP 版本将专注于处理 YAML 数据和 .docx 模板。
    

## 3. User Interface Design Goals (用户界面设计目标)

由于 `Docu-Weaver` Agent 主要是通过文本聊天界面进行交互，其“用户界面”即为对话本身。设计目标旨在确保这种交互体验清晰、高效且用户友好。

### Overall UX Vision (整体用户体验愿景)

`Docu-Weaver` Agent 应被感知为一个专业、可靠且善于沟通的自动化文档助理。用户与其交互的过程应该像与一位思路清晰的同事协作，而非操作一个冰冷的工具。

### Key Interaction Paradigms (关键交互模式)

- **引导式对话 (Guided Conversation)**: Agent 应主导对话流程，在每个阶段都为用户提供清晰的选项和下一步操作的建议。
    
- **明确请求与反馈 (Explicit Requests & Feedback)**: Agent 的所有提问都应直接、无歧义。对于用户的每一个指令，Agent 都应给予明确的确认反馈。
    
- **格式化输出 (Formatted Output)**: 所有中间沟通信息，都应使用 Markdown 进行格式化，以增强可读性。
    

### Core Screens and Views (核心“界面”与“视图”)

- **欢迎与任务启动视图**: Agent 的初始响应，用于介绍自身能力并请求用户提供必要的输入（数据目录和模板文件）。
    
- **计划确认视图**: 在分析完输入后，Agent 展示其生成计划并提供执行选项。
    
- **增量审查视图**: Agent 呈现单份已生成的文档，并请求用户审阅和反馈。
    

## 4. Technical Assumptions (技术假设)

`Docu-Weaver` Agent 的核心产出是一套高度优化的、可执行的**指令集 (Instruction Set)**，而非一个独立的软件应用。这套指令集将赋予一个通用的大语言模型（LLM）扮演 `Docu-Weaver` 角色的能力，并由该 LLM 在后台调用核心的 Python 脚本来完成实际的文件操作。

- **Repository Structure (仓库结构)**: 我们的主要工作将是构建和维护一个包含这套核心指令的文本文件（例如，`docu-weaver-prompt.md`）以及一个核心的 Python 脚本 (`generate_docs.py`)。
    
- **Service Architecture (服务架构)**: 无。`Docu-Weaver` 将在现有的 LLM 平台中运行，我们**不构建**独立的服务。
    
- **Testing Requirements (测试要求)**:
    
    - 测试将以“**指令评估**”和“**脚本测试**”两种形式进行。
        
    - **指令评估**: 验证 LLM Agent 是否能稳定、一致地遵循我们定义的交互工作流（FR5）。
        
    - **脚本测试**: 对 `generate_docs.py` 脚本进行单元测试，确保其文件读写和内容填充功能的正确性。
        

## 5. Epic and Story Structure (史诗与故事结构)

为了实现 MVP 目标，我们将所有工作归纳到一个核心史诗中，并将其分解为三个逻辑上递进的用户故事。

### Epic 1: MVP - End-to-End Document Generation Workflow

**Epic Goal**: 实现 `Docu-Weaver` Agent 的核心能力，使其能够接收用户指定的结构化数据和模板，并通过一个完整的交互式工作流，成功生成一套内容准确、格式统一的最终文档。

### Story 1.1: 任务启动与输入接收

As a 用户,

I want Docu-Weaver Agent 在会话开始时主动引导我，并清晰地要求我提供数据源和模板文件,

so that 我可以顺利地开启一个文档生成任务。

#### Acceptance Criteria (验收标准)

1. Agent 在会话开始时，必须发送一段欢迎语，并简要介绍其核心功能。
    
2. Agent 必须清晰地提示用户提供数据源的路径（或上传文件）和模板文件的路径（或上传文件）。
    
3. Agent 在收到所有必需的输入后，必须发送一条确认信息，表明输入已接收完毕。
    

### Story 1.2: 数据解析与生成计划确认

As a 用户,

I want Docu-Weaver Agent 在接收输入后，能够分析出将要生成的文档总数，并将这个计划呈现给我以供确认,

so that 我能对即将发生的工作有一个清晰的预期，并能主导任务的执行。

#### Acceptance Criteria (验收标准)

1. Agent 必须能准确地从数据源中解析出需要生成的文档总数。
    
2. Agent 必须向用户呈现一个明确的工作计划，例如：“分析完成。我将为您生成共10份文档。”
    
3. Agent 必须提供至少两种执行选项供用户选择，例如：“1. 全部生成”和“2. 逐一生成”。
    
4. Agent 必须在用户做出选择前，暂停执行，等待用户的明确指令。
    

### Story 1.3: 增量生成与交互式审查

As a 用户,

I want Docu-Weaver Agent 采用“一次一份”的方式生成文档，每完成一份就展示给我审查，并等待我的反馈,

so that 我可以确保每一份文档的质量都符合要求，并能随时对生成过程进行微调。

#### Acceptance Criteria (验收标准)

1. 在收到用户的“继续”指令后，Agent 必须生成并呈现第一份（或下一份）最终文档的预览或确认信息。
    
2. 生成的文档内容必须准确地将数据源内容映射到模板的各个部分。
    
3. 在呈现文档后，Agent 必须主动询问用户是否满意，并请求下一步指令（例如，“请您审阅。是否继续生成下一份？”）。
    
4. Agent 必须能够重复此“生成-审查”循环，直到所有指定的文档都生成并获得用户确认。