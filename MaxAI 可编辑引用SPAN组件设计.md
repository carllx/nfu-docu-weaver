
## SPAN 组件
创建一个span 组件, 用于Add to Chat 按钮点击后储存所选文字, 它是显示在文本编辑器组件内，它具有以下特点：

1. 核心功能：
- 支持插入普通文本编辑, 
- 可以插入非可编辑的引用标记
- 点击可以索引到所选 span 的来源 Material  (如何实现点击索引到来源？)
- 引用标记支持文件名和行号显示
- 支持在文本编辑内删除, 复制、剪切和粘贴

1. 技术架构：
- 基于 React 和 TypeScript 开发 
- 采用 React 的 Virtual DOM 优化性能, 引入状态管理机制
- Settings 引用数据的持久化存储 : 
- 使用 contentEditable div 实现富文本编辑

2. UI设计：
- 引用标记采用灰色背景突出显示
- 响应式布局适配


## Material 组件

支持打开并预览指定的 Markdown 文档的具体某几行，包括选择高亮具体的开始和结束行数。
例如MarkdownSectionInformation 接口：这个接口提供了 Markdown 文档中 section 的 lineStart, lineEnd, 和 text 信息。虽然这个接口不能直接跳转到指定的行，但是它可以提供 section 的起始和结束行号。

滚动到指定行：
源材料并没有直接提供滚动到指定行的 API。但是，MarkdownView 可能会提供一些方法来操作编辑器，或者可以访问 CodeMirror 6 的实例来实现。
可以尝试访问 MarkdownView.editor 属性来获取编辑器实例。
然后，您可以使用 CodeMirror 6 的 API 来滚动到指定的行。您可能需要查阅 CodeMirror 6 的官方文档来找到正确的 API。
MarkdownEditView，它是 Obsidian Mobile 以及即将推出的 WYSIWYG 编辑器的编辑器，它有 applyScroll() 方法。


## Answer
输出答案将插入引用, 能链接到文档中的特定位置
支持链接到文档中的特定部分：可以使用内部链接跳转到文档中的特定部分，例如标题或块 ID。虽然这不能直接跳转到行号，但可以链接到文档中的特定位置。

问题：

1. 引用标记的具体交互方式：
- 
- 引用标记的文件名和行号如何展示？
- 是否支持多层级引用？

2. 编辑功能的边界：
- 引用标记是否可以部分编辑？
- 如何处理引用标记与普通文本的混排？
- 复制粘贴时如何保持引用标记的完整性？

1. 技术实现细节：
- contentEditable 如何处理复杂的数据结构？
- 如何保证跨浏览器兼容性？
- 性能优化方案是什么？

建议：

2. 功能完善：
- 添加引用预览功能
- 支持引用片段的批注和评论
- 增加版本控制功能
- 提供引用溯源记录

1. 交互优化：
- 增加快捷键操作支持
- 提供引用标记的样式自定义
- 添加引用关系可视化展示
- 优化移动端的操作体验



2. 可维护性：
- 完善错误处理机制
- 添加单元测试和集成测试
- 规范化组件文档
- 建立开发规范指南

### 建议的问题：
- 如果要支持多层级引用，那么数据结构该如何设计才能有效地管理和呈现这些嵌套引用？
- 除了React和TypeScript，还有哪些技术栈可以选择来实现这个可编辑引用SPAN组件？它们各自的优缺点是什么？
- 在实现引用数据的持久化存储时，应该选择哪种数据库技术？如何保证数据的完整性和一致性？

让我通过一个具体的例子来说明多层级引用：

假设我们在讨论一篇学术论文：

第一层引用：
> 张教授(2024)在《人工智能发展趋势》中指出："AI技术正在快速发展。"

第二层引用：
> 李研究员在评论张教授的观点时写道：
>> "张教授提到的'AI技术快速发展'这一论点值得深入探讨。"

第三层引用：
> 王博士在其综述中这样分析：
>> 李研究员的评论很有见地，特别是他提到：
>>> "张教授的观点需要深入探讨"这一建议。

多层级引用的特点：
1. 层次分明：每一层引用都有清晰的缩进和标记
2. 来源清晰：每个引用都标明了出处
3. 逻辑连贯：引用之间存在逻辑关联
4. 格式规范：通常使用不同数量的引用符号（>）来区分层级

根据您提供的MaxAI组件设计参考，这种多层级引用在技术实现上需要：
- 支持嵌套的引用标记
- 每层引用有独特的视觉样式
- 可追溯引用源
- 保持文本的可编辑性

这种多层级引用在学术写作、新闻报道和在线讨论中特别有用，能够清晰地展示不同来源的观点以及它们之间的关系。

### 建议的问题：
- 除了学术论文，多层级引用在其他类型的文本中是如何使用的？例如，新闻报道或在线论坛。
- MaxAI组件的设计中，如何处理不同层级引用之间的视觉区分，以及如何确保它们在编辑过程中保持一致性？
- 如果引用来源信息缺失或不完整，MaxAI组件该如何处理？例如，如何处理匿名来源或无法追溯的引用？

