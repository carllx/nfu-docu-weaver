# test 
textList <- c(
"BRAUN VIRGINIA., 2006, QUAL. RES. PSYCHOL, V3, P77, DOI DOI 10.1191/1478088706QP063OA, 10.1191/1478088706QP063OA",
"FORNELL C, 1981, J MARKETING RES, V18, P39, DOI 10.2307/3151312",
"DAVIS FD, 1989, MIS QUART, V13, P319, DOI 10.2307/249008",
"HAIR J.F., 2010, MULTIVARIATE DATA ANALYSIS, DOI DOI 10.1016/J.IJPHARM.2011.02.019",
"COHEN J., 1988, STATISTICAL POWER ANALYSIS FOR THE BEHAVIORAL SCIENCES, V2ND, DOI 10.4324/9780203771587, DOI 10.4324/9780203771587",
"VENKATESH V, 2003, MIS QUART, V27, P425, DOI 10.2307/30036540",
"BLEI DM, 2003, J MACH LEARN RES, V3, P993, DOI 10.1162/JMLR.2003.3.4-5.993",
"HSIEH HF, 2005, QUAL HEALTH RES, V15, P1277, DOI 10.1177/1049732305276687",
"HU LT, 1999, STRUCT EQU MODELING, V6, P1, DOI 10.1080/10705519909540118",
"AJZEN I, 1991, ORGAN BEHAV HUM DEC, V50, P179, DOI 10.1016/0749-5978(91)90020-T",
"DAVIS FD, 1989, MANAGE SCI, V35, P982, DOI 10.1287/MNSC.35.8.982",
"HENSELER J, 2015, J ACAD MARKET SCI, V43, P115, DOI 10.1007/S11747-014-0403-8",
"MOHER D, 2009, PLOS MED, V6, DOI 10.1136/BMJ.B2700, 10.1371/JOURNAL.PMED.1000097, 10.1016/J.IJSU.2010.07.299, 10.1016/J.IJSU.2010.02.007, 10.1186/2046-4053-4-1, 10.1136/BMJ.I4086, 10.1136/BMJ.B2535",
"VYGOTSKY L. S., 1978, MIND IN SOCIETY: THE DEVELOPMENT OF HIGHER PSYCHOLOGICAL PROCESSES, DOI 10.2307/J.CTVJF9VZ4",
"GARRISON D. R., 1999, INTERNET AND HIGHER EDUCATION, V2, P87, DOI 10.1016/S1096-7516(00)00016-6",
"KIZILCEC RF, 2013, P 3 INT C LEARN AN K, P170, DOI 10.1145/2460296.2460330, DOI 10.1145/2460296.2460330",
"PODSAKOFF PM, 2003, J APPL PSYCHOL, V88, P879, DOI 10.1037/0021-9010.88.5.879",
"ANDERSON JC, 1988, PSYCHOL BULL, V103, P411, DOI 10.1037/0033-2909.103.3.411",
"DHAWAN SHIVANGI, 2020, JOURNAL OF EDUCATIONAL TECHNOLOGY SYSTEMS, V49, P5, DOI 10.1177/0047239520934018",
"HAIR JF, 2019, EUR BUS REV, V31, P2, DOI 10.1108/EBR-11-2018-0203",
"HONE KS, 2016, COMPUT EDUC, V98, P157, DOI 10.1016/J.COMPEDU.2016.03.016",
"KAPLAN AM, 2010, BUS HORIZONS, V53, P59, DOI 10.1016/J.BUSHOR.2009.09.003",
"BOYD DM, 2007, J COMPUT-MEDIAT COMM, V13, P210, DOI 10.1111/J.1083-6101.2007.00393.X",
"HEW KF, 2014, EDUC RES REV-NETH, V12, P45, DOI 10.1016/J.EDUREV.2014.05.001",
"VENKATESH V, 2000, MANAGE SCI, V46, P186, DOI 10.1287/MNSC.46.2.186.11926",
"ALRAIMI KM, 2015, COMPUT EDUC, V80, P28, DOI 10.1016/J.COMPEDU.2014.08.006",
"LIYANAGUNAWARDENA TR, 2013, INT REV RES OPEN DIS, V14, P202, DOI 10.19173/IRRODL.V14I3.1455",
"NUNNALLY J. C., 1978, PSYCHOMETRIC THEORY, V2ND",
"SUN PC, 2008, COMPUT EDUC, V50, P1183, DOI 10.1016/J.COMPEDU.2006.11.007",
"ANONYMOUS, THESIS",
"BRESLOW L, 2013, RES PRACTICE ASSESSM, V8, P13, DOI DOI 10.19173/IRRODL.V18I5.3080",
"CRESWELL J. W., 2018, RESEARCH DESIGN: QUALITATIVE, QUANTITATIVE, AND MIXED METHODS APPROACHES, V5TH ED., DOI DOI 10.5539/ELT.V12N5P40",
"HAIR JF, 2011, J MARKET THEORY PRAC, V19, P139, DOI 10.2753/MTP1069-6679190202",
"MILES M. B., 1994, QUALITATIVE DATA ANA",
"BAO W, 2020, HUM BEHAV EMERG TECH, V2, P113, DOI 10.1002/HBE2.191",
"BHATTACHERJEE A, 2001, MIS QUART, V25, P351, DOI 10.2307/3250921",
"LAVE J., 1991, SITUATED LEARNING LE, V1ST ED., DOI DOI 10.1017/CBO9780511815355, 10.1017/CBO9780511815355",
"VENKATESH V, 2012, MIS QUART, V36, P157",
"BANDURA A, 1977, PSYCHOL REV, V84, P191, DOI 10.1037/0033-295X.84.2.191",
"BANDURA A., 1977, SOCIAL LEARNING THEORY",
"FREDRICKS JA, 2004, REV EDUC RES, V74, P59, DOI 10.3102/00346543074001059",
"RYAN RM, 2000, AM PSYCHOL, V55, P68, DOI 10.1037/0003-066X.55.1.68",
"ADNAN M., 2020, ONLINE SUBMISSION, V1, P45, DOI 10.33902/JPSP.2020261309, DOI 10.33902/JPSP.2020261309, 10.33902/JPSP.2020261309, 10.33902/JPSP. 2020261309",
"RUIZ JG, 2006, ACAD MED, V81, P207, DOI 10.1097/00001888-200603000-00002",
"FERGUSON R, 2012, INT J TECHNOL ENHANC, V4, P304, DOI 10.1504/IJTEL.2012.051816",
"GARRISON D. R., 2004, INTERNET AND HIGHER EDUCATION, V7, P95, DOI 10.1016/J.IHEDUC.2004.02.001",
"MOORE MG., 1989, EDITORIAL: THREE TYPES OF INTERACTION, V3, P1, DOI 10.1080/08923648909526659, DOI 10.1080/08923648909526659",
"R CORE TEAM, 2022, R LANGUAGE ENV STAT, DOI DOI 10.1007/978-3-540-74686-7",
"SALDANA J., 2016, THE CODING MANUAL FOR QUALITATIVE RESEARCHERS, DOI DOI 10.1017/CBO9781107415324.004",
"TABACHNICK B. G., 2007, USING MULTIVARIATE STATISTICS, V5TH ED."
)

doiExtract <- function(text) {
  # Regular expression pattern to match DOI formats, capturing addresses with or without 'DOI' prefix
  pattern <- "(?:DOI\\s+)?([0-9\\.]+/[\\w\\d\\.\\-\\/_]+)"
  
  # Extract matches
  matches <- gregexpr(pattern, text, perl = TRUE)
  all_dois <- regmatches(text, matches)
  
  # Process each match to remove duplicates and concatenate addresses
  extracted_dois <- sapply(all_dois, function(doi_group) {
    unique_dois <- unique(doi_group)
    # Concatenate unique DOI addresses with ';'
    paste(unique_dois, collapse = ";")
    # Remove 'DOI' prefix from each address 
    paste(sub("DOI\\s+", "", unique_dois), collapse = ";")
  })
  
  return(extracted_dois)
}

for(text in textList) {
  print(doiExtract(text))
}
