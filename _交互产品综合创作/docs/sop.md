# 工作流操作手册 (SOP): 《交互产品综合创作》课程

**版本: 10.2 (资源整合强化版)**

**制定者: John (Product Manager)**

**最后更新: 2025-08-31**

## **1. 概述与核心原则 (Overview & Core Principles)**

本文档是《交互产品综合创作》课程内容自动化生产流程的**唯一标准操作规程 (SOP)**。所有团队成员（包括教师和BMAD智能体）都必须严格遵循本手册定义的流程。

本工作流（V10.1版）基于以下核心原则设计：

- **Story驱动执行 (Story-Driven Execution)**: 所有核心生产任务（内容分析、幻灯片制作）都必须封装在一个标准的Story文档中。Story是工作流的核心驱动单元。
    
- **人机分离与协同**:
    
    - **人类专属职责**: 教师负责战略决策、创意输入、以及**文件的移动、重命名、删除和归档**。
        
    - **AI能力限制**: AI代理严格限定于**读取、创建和编辑文件**，严禁执行任何文件移动或删除操作。
        
- **缓冲区工作流 (Inbox Workflow)**: 所有新素材必须先进入`00_INBOX/`，由AI完成策展“注册”后，再由教师进行最终的自由整理。
    
- **明确的AI禁区**: AI代理严禁读取或操作`_IGNORE_DO_NOT_PROCESS/`目录下的任何内容。
    
- **数据驱动**: AI的核心任务输入被链接在Story内部，确保指令的精确性。
    

## **2. 角色与职责 (Roles & Responsibilities)**

| **角色**                                   | **BMAD成员**    | **核心职责**                                                                                                                                                                                                         |
| ---------------------------------------- | ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **总指挥 (Commander)**                      | **教师 (您)**    | 1. **创作**: 在`src/00_INBOX/`中添加原始教学素材。<br>2. **决策**: 监控仪表盘，决定何时触发“资源策展”任务。<br>3. **发布**: 在每周开始前，从仪表盘导出当周的`.csv`任务文件。<br>4. **指令**: 根据每个产出物末尾的“Handoff协议”，调用相应AI代理执行下一步。<br>5. **整理**: 在AI完成策展后，自由移动和组织已“注册”的笔记文件。 |
| **Scrum Master**                         | **SM**        | 接收总指挥指令，使用`TPL_Story.md`模板创建每周的“双子Story”。**必须**从`prd.md`和`architecture.md`中提取并填充所有必要的上下文。                                                                                                                        |
| **策展分析师 (Curation Analyst)**             | **Mary**      | **【核心约束】** 接收总指挥指令，**只扫描`INBOX`**，为每个笔记**在原文件顶部**添加或编辑完整的YAML属性头（包括`course_name`），然后将其**移动到建议的初始归档位置**。严禁创建文件副本。                                                                                                 |
| **内容生产分析师 (Content Production Analyst)** | **Mary**      | 接收“内容生产Story”，深度阅读Story中链接的所有源文件，撰写`Week_XX.md`教学单元草稿。                                                                                                                                                           |
| **产品负责人 (Product Owner)**                | **Sarah**     | 审核`Week_XX.md`草稿的质量，并在对应的Story文档中更新QA结果。                                                                                                                                                                         |
| **开发者 (Developer)**                      | **Developer** | 接收“幻灯片制作Story”，将通过审核的`Week_XX.md`转化为最终的`.marpit.md`幻灯片。                                                                                                                                                          |

## **3. 关键产出物与数据规范 (Key Artifacts & Data Specs)**

### **3.1 标准化笔记属性 (YAML Frontmatter)**

所有位于`/src/`目录下的`.md`文件必须包含以下属性：

| **属性名**       | **数据类型** | **描述**                               |
| ------------- | -------- | ------------------------------------ |
| `course_name` | Text     | **[强制]** 课程的唯一名称，如 "交互产品综合创作"。       |
| `week_num`    | Number   | 笔记所属的周次。                             |
| `epic_num`    | Number   | 笔记所属的史诗编号。                           |
| `sequence`    | Number   | 在同一周内的处理顺序。                          |
| `type`        | Text     | 素材类型 (如 `理论视频`, `补充笔记`)。             |
| `status`      | Text     | 策展状态 (`draft`, `ready`, `archived`)。 |
| `tldr`        | Text     | 由“策展分析师”生成的笔记核心摘要。                   |

_... (其余数据规范与Story模板结构部分，与architecture.md v3.3保持一致，此处省略) ..._

## **4. 标准操作流程 (Standard Operating Procedures)**

### **流程 A: 资源策展 (按需维护，教师与AI协同)**

1. **触发 (教师)**: 教师在`src/00_INBOX/`中添加了新的笔记。
    
2. **指令 (教师 -> Analyst)**: 教师调用**策展分析师(Mary)**，指令其对`INBOX`执行“资源策展”。
    
3. **执行 (Analyst Mary)**:
	- **a. 分析**: Mary **阅读** `INBOX` 中每个文件的**全文内容**。
	- **b. 提炼**: 从正文中提炼出生成YAML属性所需的核心信息。
	- **c. 构建指令**: Mary 根据提炼出的信息，为每一个文件**构建一个精确的 `frontmatter_tool.py` 执行命令**。
	- **d. 执行工具**: Mary **执行构建好的Python脚本命令**，由脚本自动完成对文件的修改。
	- **e. 归档**: 脚本执行成功后，Mary将处理过的文件移动到建议的初始归档位置。
    
4. **完成 (AI)**: `INBOX`被清空，仪表盘自动更新。
    
5. **最终整理 (教师)**: 教师现在可以**自由地**将这些已被AI“注册”过的笔记文件，移动到任何您认为合适的位置或您新建的文件夹中。
    

### **流程 B: 教学单元生成 (每周核心)**

1. **触发 (教师)**: 新的一周开始。
    
2. **发布 (教师)**: 教师打开`00_RESOURCE_DASHBOARD.md`，导出当周的`export/RESOURCE_MAP_WXX.csv`文件。
    
3. **指令 (教师 -> SM)**: 教师调用**SM代理**，指令其根据发布的CSV文件创建当周的“内容生产Story”。
    
4. **执行 (SM)**: SM代理创建Story，填充所有上下文，并指派给**内容生产分析师(Mary)**。
    
5. **执行 (Analyst Mary)**: Mary接收Story，深度阅读所有源文件，撰写`Week_XX.md`草稿，完成后更新Story状态和Handoff协议。`@analyst Mary  *create-doc  {{story.md}}`
		
    
6. **指令 (教师 -> PO)**: 教师根据Handoff指令，调用**产品负责人(Sarah)**进行审核。`@po.md *po Sarah 审核此{{Week_01.md}}草稿，确保内容完整性并满足所有验收标准，特别是细节验证AC中关于"画框与组区别"的解释。`
    
7. **执行 (PO Sarah)**: Sarah审核后更新Story和Handoff协议。
    

### **流程 C: 幻灯片制作 (每周核心)**

1. **触发**: `Week_XX.md`通过PO审核。
    
2. **指令 (教师 -> SM)**: 教师根据`Week_XX.md`末尾的Handoff指令，调用**SM代理**为Developer创建“幻灯片制作Story”。
    
3. **执行 (SM -> Developer)**: SM创建Story并指派给Developer。
    
4. **执行 (Developer)**: Developer接收Story，生成`.marpit.md`幻灯片，并更新Story状态。
    
## **5. 核心工具集使用指南 (Core Toolset Guide)**

### **5.1 `frontmatter_tool.py` 脚本使用指南 (SOP for Analyst)**

> **目标**：确保项目中的所有 Markdown 文件都拥有统一、正确的 YAML frontmatter 属性。

#### **核心功能**

- **添加/更新属性**: 向文件添加或更新标准的属性块。
    
- **删除属性**: 移除文件中已存在的整个 frontmatter 属性块。
    

#### **工作流程一：处理单个文件**

> 遵循“先删除，后添加”的原则来确保最终结果的正确性。

**步骤:**

1. **阅读与分析**: 阅读文件，提炼正确的属性信息。
    
2. **执行删除 (可选但推荐)**: 清理旧信息。
    
    ```
    python /tools/frontmatter_tool.py "你的文件绝对路径" --remove
    ```
    
3. **执行添加**: 使用正确信息执行添加。
    
    ```
    python /tools/frontmatter_tool.py "你的文件绝对路径" --week_num [周次] --type "[类型]" --tldr "[摘要]" ...
    ```
    

#### **工作流程二：批量处理多个文件 (`src/00_INBOX/`)**

**步骤:**

1. **信息汇总**: 批量阅读`INBOX`中所有文件，整理出每个文件所需的属性。

2. **生成命令序列**: 为每一个文件生成一个独立的、完整的 `frontmatter_tool.py` 添加命令。

3. **批量执行**: 依次执行所有生成的命令。

#### **工作流程三：教学资源深度整合与内容生产**

**步骤:**

1. **资源分类与优先级排序**
   - **核心理论资源**: 课程理念、设计理论、工具定位、UI/UX基础概念
   - **技术操作资源**: 具体工具使用、界面操作、画框组区别等
   - **实践项目资源**: 项目案例、操作步骤、用户画像等
   - **辅助资源**: 版本差异、认证信息、扩展知识

2. **内容整合策略**
   - **理论基础层**: 整合课程理念、UI/UX概念、设计理论
   - **技术操作层**: 整合工具使用、界面操作、具体技巧
   - **实践应用层**: 整合项目案例、操作步骤、实际应用
   - **进阶拓展层**: 整合版本差异、认证信息、行业洞察

3. **资源引用标准化**
   - **核心概念引用**: `(来源: [[文件名]])`
   - **技术细节引用**: `(参考: [[文件名#章节]])`
   - **实践步骤引用**: `(操作指南: [[文件名]])`
   - **理论基础引用**: `(理论依据: [[文件名]])`

4. **质量控制标准**
   - **完整性要求**: 每个CSV列出的资源至少被引用1次
   - **深度要求**: 核心资源需深度整合，提取关键价值
   - **逻辑连贯**: 教学内容按照从理论到实践的逻辑组织
   - **引用准确**: 所有引用指向正确的源文件和章节
    

#### **重要提示**

- **路径问题**: 文件路径必须是绝对路径，并用双引号 `" "` 包裹。
    
- **幂等性**: “添加”操作是幂等的，对已有正确属性的文件执行会安全跳过。
## **附录 A: 教师操作指南 (Commander's Playbook)**

本指南为您（总指挥）提供清晰的、场景化的行动指令。

### **场景〇：如何开始一次新的工作会话？**

> 当您重新启动项目或开启一个新的聊天会话时，为了让BMAD团队快速同步项目状态，请执行以下操作：

1. **您的行动**: 准备好三份核心文档：`prd.md`, `architecture.md`, `sop.md`。
    
2. **下达指令**: 调用团队中的任一核心角色（推荐Analyst），并提供这三份文档作为初始上下文。
    
    > **标准启动命令**: `@analyst project documents` (然后上传或引用 `prd.md`, `architecture.md`, `sop.md`) **然后说**: `我们来继续[您想做的事]`。
    

### **场景一：我写了一批新笔记，该做什么？**

1. **您的行动**: 将所有新笔记文件放入`/src/00_INBOX/`目录。
    
2. **检查仪表盘**: 打开`00_RESOURCE_DASHBOARD.md`，在“策展收件箱”视图中确认您的文件已出现。
    
3. **下达指令**: 当您准备好整理时，调用Analyst Mary。
    
    > **建议命令**: `@analyst Mary, 请为我执行“资源策展”任务，处理 ./src/00_INBOX/ 中的所有新笔记。`
    
4. **您的行动 (整理)**: 等待Mary处理完毕后，您可以进入`/src/`下的对应文件夹，将笔记移动到您期望的最终位置。
    

### **场景二：如何启动新一周的内容生产？**

1. **您的行动**: 打开`00_RESOURCE_DASHBOARD.md`，切换到您想启动的周次视图。
    
2. **发布资源**: 导出对应的`.csv`文件。
    
3. **下达指令**: 确认CSV文件已保存后，调用SM代理。
    
    > **建议命令**: `@sm` 然后 `请根据已发布的CSV文件，为第三周创建“内容生产Story”。`
    

### **场景三：AI完成了一个任务，我该做什么？**

1. **您的行动**: 打开AI交付的文档（例如`Week_03.md`）。
    
2. **阅读交接协议**: 滚动到文件最下方，阅读“Handoff Protocol”部分。
    
3. **下达指令**: 复制“教师指令”中建议的命令，调用下一个AI代理执行任务。

## **附录 B: 验收标准 (AC) 编写指南**

为确保“内容生产分析师”进行深度阅读，SM代理在创建其Story时，必须加入一个“细节验证AC”。

**原则**: 该AC应提出一个**只有在阅读了源文件全文后才能回答的问题或完成的任务**。

**范例一 (基于内容)**:

> **AC-细节验证**: 草稿中对“画框与组的区别”的解释，必须包含源文件`[[vid-figma-015-frames-vs-groups]]`正文中提到的关于“剪裁蒙版(clipping mask)”行为的具体差异。

**范例二 (基于结构)**:

> **AC-细节验证**: 草稿必须根据源文件`[[vid-spline-005-states-events]]`中的步骤，创建一个关于“悬停显示价格”交互的完整操作指引。

## **附录 C: 错误处理与回退流程**

- **PO审核打回**: 如果PO Sarah审核不通过`Week_XX.md`，她会将对应的Story状态重新标记为`InProgress`并指派回Analyst Mary，同时在Story的“QA结果”部分附上具体的修改意见。Mary必须完成修改后重新提交审核。
- **CSV文件缺失**: 如果SM代理在启动周度任务时未找到对应的`export/RESOURCE_MAP_WXX.csv`文件，它将暂停创建Story，并向教师（您）发出通知，请求您先导出并发布该周的资源地图。

---
### **Handoff Protocol v1.0**

- **本阶段任务已完成**: `sop.md` 已更新至 v10.2，强化了资源整合流程规范。

- **产出物**: `sop.md` v10.2 (资源整合强化版)

- **下一步状态**: **准备就绪 (Ready for Execution)**

- **下一步执行者**: **教师 (总指挥)**

- **教师指令**:

    > SOP已升级至v10.2，强化了教学资源深度整合流程。请根据新的资源整合规范重新审视和优化内容生产流程，确保充分利用所有可用资源。
